services:
  knowyoursos-configurationserver:
    build:
        context: ./KnowYourSOS-ConfigurationServer
        dockerfile: ../Dockerfile
        args:
          SERVICE_NAME: ConfigurationServer
    container_name: knowyoursos-configurationserver
    environment:
      - SERVICE_TO_WAIT_FOR=${CONFIGURATIONSERVER_SERVICE_TO_WAIT_FOR_NAME}
    networks:
      - backend
  knowyoursos-eurekaserver:
    build:
      context: ./KnowYourSOS-EurekaServer
      dockerfile: ../Dockerfile
      args:
        SERVICE_NAME: EurekaServer
    container_name: knowyoursos-eurekaserver
    environment:
      - SERVICE_TO_WAIT_FOR=${EUREKASERVER_SERVICE_TO_WAIT_FOR_NAME}:${EUREKASERVER_SERVICE_TO_WAIT_FOR_PORT}
    depends_on:
      - knowyoursos-configurationserver
    networks:
      - backend
  knowyoursos-apigateway:
    build:
      context: ./KnowYourSOS-ApiGateway
      dockerfile: ../Dockerfile
      args:
        SERVICE_NAME: UpdateDBMicroservice
    container_name: knowyoursos-apigateway
    ports:
          - "8222:8222"
    depends_on:
      - knowyoursos-eurekaserver
    environment:
      - SERVICE_TO_WAIT_FOR=${APIGATEWAY_SERVICE_TO_WAIT_FOR_NAME}:${APIGATEWAY_SERVICE_TO_WAIT_FOR_PORT}
    networks:
      - backend
  knowyoursos-sosnumbermicroservice:
    build:
      context: ./KnowYourSOS-SOSNumberMicroservice
      dockerfile: ../Dockerfile
      args:
        SERVICE_NAME: UpdateDBMicroservice
    container_name: knowyoursos-sosnumbermicroservice
    depends_on:
      - knowyoursos-eurekaserver
    environment:
      - SERVICE_TO_WAIT_FOR=${SOSNUMBERSMICROSERVICE_SERVICE_TO_WAIT_FOR_NAME}:${SOSNUMBERSMICROSERVICE_SERVICE_TO_WAIT_FOR_PORT}
    networks:
      - backend
  knowyoursos-updatedbmicroservice:
    build:
      context: ./KnowYourSOS-UpdateDBMicroservice
      dockerfile: ../Dockerfile
      args:
        SERVICE_NAME: UpdateDBMicroservice
    container_name: knowyoursos-updatedbmicroservice
    depends_on:
      - knowyoursos-eurekaserver
    environment:
      - SERVICE_TO_WAIT_FOR=${UPDATEDBMICROSERVICE_SERVICE_TO_WAIT_FOR_NAME}:${UPDATEDBMICROSERVICE_SERVICE_TO_WAIT_FOR_PORT}
    networks:
      - backend
  knowyoursos-sosdatabase:
    image: postgres:15
    environment:
      POSTGRES_DB: ${SOSDATABASE_DB_NAME}
      POSTGRES_USER: ${SOSDATABASE_DB_USERNAME}
      POSTGRES_PASSWORD: ${SOSDATABASE_DB_PASSWORD}
    ports:
      - "5432:5432"
    networks:
      - backend
networks:
  backend:
    driver: bridge
